---
title: "å®˜æ–¹ Python SDK"
description: "Z.ai Python SDK æ¦‚è¿°ä¸ä»‹ç»"
---

<Info>
Z.ai Python SDK æ˜¯æ™ºè°±AIå®˜æ–¹æä¾›çš„Pythonå¼€å‘å·¥å…·åŒ…ï¼Œä¸ºPythonå¼€å‘è€…æä¾›ä¾¿æ·ã€é«˜æ•ˆçš„AIæ¨¡å‹é›†æˆæ–¹æ¡ˆã€‚
</Info>

## ä»€ä¹ˆæ˜¯ Z.ai Python SDK

Z.ai Python SDK æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€æ˜“äºä½¿ç”¨çš„Pythonå¼€å‘å·¥å…·åŒ…ï¼Œä¸“ä¸ºä¸æ™ºè°±AIçš„å„ç§äººå·¥æ™ºèƒ½æ¨¡å‹è¿›è¡Œäº¤äº’è€Œè®¾è®¡ã€‚æ— è®ºæ‚¨æ˜¯è¦æ„å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººã€å†…å®¹ç”Ÿæˆåº”ç”¨ï¼Œè¿˜æ˜¯éœ€è¦åœ¨ç°æœ‰Pythonåº”ç”¨ä¸­é›†æˆAIåŠŸèƒ½ï¼Œæˆ‘ä»¬çš„SDKéƒ½èƒ½ä¸ºæ‚¨æä¾›å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚

### æ ¸å¿ƒä¼˜åŠ¿

<CardGroup cols={2}>
  <Card title="ç®€å•æ˜“ç”¨" icon="rocket">
    Pythonicçš„APIè®¾è®¡ï¼Œå®Œå–„çš„æ–‡æ¡£å’Œç¤ºä¾‹ï¼Œè®©æ‚¨å¿«é€Ÿä¸Šæ‰‹
  </Card>
  <Card title="åŠŸèƒ½å®Œæ•´" icon="puzzle-piece">
    æ”¯æŒæ™ºè°±AIå…¨ç³»åˆ—æ¨¡å‹ï¼ŒåŒ…æ‹¬è¯­è¨€ã€è§†è§‰ã€å›¾åƒç”Ÿæˆç­‰
  </Card>
  <Card title="é«˜æ€§èƒ½" icon="gauge-high">
    å¼‚æ­¥æ”¯æŒã€è¿æ¥æ± ç®¡ç†ï¼Œä¼˜åŒ–çš„ç½‘ç»œè¯·æ±‚å¤„ç†
  </Card>
  <Card title="ç±»å‹å®‰å…¨" icon="shield-check">
    å®Œæ•´çš„ç±»å‹æç¤ºï¼ŒIDEå‹å¥½ï¼Œå‡å°‘å¼€å‘é”™è¯¯
  </Card>
</CardGroup>

### æ”¯æŒçš„åŠŸèƒ½

- **ğŸ’¬ å¯¹è¯èŠå¤©**ï¼šæ”¯æŒå•è½®å’Œå¤šè½®å¯¹è¯ï¼Œæµå¼å’Œéæµå¼å“åº”
- **ğŸ”§ å‡½æ•°è°ƒç”¨**ï¼šè®©AIæ¨¡å‹è°ƒç”¨æ‚¨çš„è‡ªå®šä¹‰å‡½æ•°
- **ğŸ‘ï¸ è§†è§‰ç†è§£**ï¼šå›¾åƒåˆ†æã€OCRã€è§†è§‰é—®ç­”
- **ğŸ¨ å›¾åƒç”Ÿæˆ**ï¼šæ ¹æ®æ–‡æœ¬æè¿°ç”Ÿæˆé«˜è´¨é‡å›¾åƒ
- **ğŸ¬ è§†é¢‘ç”Ÿæˆ**ï¼šæ–‡æœ¬åˆ°è§†é¢‘çš„åˆ›æ„å†…å®¹ç”Ÿæˆ
- **ğŸ”Š è¯­éŸ³å¤„ç†**ï¼šè¯­éŸ³è½¬æ–‡å­—ã€æ–‡å­—è½¬è¯­éŸ³
- **ğŸ“Š æ–‡æœ¬åµŒå…¥**ï¼šæ–‡æœ¬å‘é‡åŒ–ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢
- **ğŸ¤– æ™ºèƒ½åŠ©æ‰‹**ï¼šæ„å»ºä¸“ä¸šçš„AIåŠ©æ‰‹åº”ç”¨
- **ğŸ“š çŸ¥è¯†åº“ç®¡ç†**ï¼šæ–‡æ¡£ä¸Šä¼ ã€æ£€ç´¢ã€é—®ç­”
- **ğŸ›¡ï¸ å†…å®¹å®¡æ ¸**ï¼šæ–‡æœ¬å’Œå›¾åƒå†…å®¹å®‰å…¨æ£€æµ‹

### æ”¯æŒçš„æ¨¡å‹

<Tabs>
  <Tab title="è¯­è¨€æ¨¡å‹">
    - **GLM-4-Plus**ï¼šæœ€å¼ºå¤§çš„è¯­è¨€ç†è§£å’Œç”Ÿæˆæ¨¡å‹
    - **GLM-4-Air**ï¼šå¹³è¡¡æ€§èƒ½å’Œæˆæœ¬çš„é€šç”¨æ¨¡å‹
    - **GLM-4-Flash**ï¼šå¿«é€Ÿå“åº”çš„è½»é‡çº§æ¨¡å‹
    - **GLM-4-Long**ï¼šæ”¯æŒè¶…é•¿ä¸Šä¸‹æ–‡çš„æ¨¡å‹
  </Tab>
  <Tab title="å¤šæ¨¡æ€æ¨¡å‹">
    - **GLM-4V-Plus**ï¼šå¼ºå¤§çš„è§†è§‰ç†è§£æ¨¡å‹
    - **GLM-4V**ï¼šé€šç”¨è§†è§‰ç†è§£æ¨¡å‹
    - **GLM-4-Voice**ï¼šè¯­éŸ³äº¤äº’æ¨¡å‹
  </Tab>
  <Tab title="ç”Ÿæˆæ¨¡å‹">
    - **CogView-3**ï¼šé«˜è´¨é‡å›¾åƒç”Ÿæˆ
    - **CogVideoX**ï¼šè§†é¢‘å†…å®¹ç”Ÿæˆ
    - **Embedding-2**ï¼šæ–‡æœ¬å‘é‡åŒ–æ¨¡å‹
  </Tab>
</Tabs>

## æŠ€æœ¯è§„æ ¼

### ç¯å¢ƒè¦æ±‚

- **Pythonç‰ˆæœ¬**ï¼šPython 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- **åŒ…ç®¡ç†å™¨**ï¼špip æˆ– poetry
- **ç½‘ç»œè¦æ±‚**ï¼šæ”¯æŒHTTPSè¿æ¥
- **APIå¯†é’¥**ï¼šéœ€è¦æœ‰æ•ˆçš„æ™ºè°±AI APIå¯†é’¥

### ä¾èµ–ç®¡ç†

SDKé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æ€§å®‰è£…åŠŸèƒ½æ¨¡å—ï¼š

- **æ ¸å¿ƒæ¨¡å—**ï¼šåŸºç¡€APIè°ƒç”¨åŠŸèƒ½
- **å¼‚æ­¥æ¨¡å—**ï¼šå¼‚æ­¥å’Œå¹¶å‘å¤„ç†æ”¯æŒ
- **å·¥å…·æ¨¡å—**ï¼šå®ç”¨å·¥å…·å’Œè¾…åŠ©åŠŸèƒ½

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

<CardGroup cols={2}>
  <Card title="Python ç‰ˆæœ¬" icon="python">
    Python 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
  </Card>
  <Card title="åŒ…ç®¡ç†å™¨" icon="package">
    pipï¼ˆæ¨èï¼‰
  </Card>
</CardGroup>

<Warning>
æ”¯æŒ Python 3.8, 3.9, 3.10, 3.11, 3.12 ç‰ˆæœ¬ï¼Œè·¨å¹³å°å…¼å®¹ Windowsã€macOSã€Linux
</Warning>

### å®‰è£… SDK

#### ä½¿ç”¨ pip å®‰è£…

```bash
# å®‰è£…æœ€æ–°ç‰ˆæœ¬
pip install zai-sdk

# æˆ–æŒ‡å®šç‰ˆæœ¬
pip install zai-sdk==1.0.0
```

#### éªŒè¯å®‰è£…

```python
import zai
print(zai.__version__)
```

### è·å– API Key

1. è®¿é—® [Zæ™ºè°±å¼€æ”¾å¹³å°](https://bigmodel.cn)
2. æ³¨å†Œå¹¶ç™»å½•æ‚¨çš„è´¦æˆ·
3. åœ¨æ§åˆ¶å°ä¸­åˆ›å»º API Key
4. å¤åˆ¶æ‚¨çš„ API Key ä»¥ä¾›ä½¿ç”¨

<Tip>
å»ºè®®å°† API Key è®¾ç½®ä¸ºç¯å¢ƒå˜é‡ï¼š`export ZAI_API_KEY=your-api-key`
</Tip>

### ç¬¬ä¸€ä¸ªç¤ºä¾‹

#### åˆ›å»ºå®¢æˆ·ç«¯

<Tabs>
  <Tab title="ç¯å¢ƒå˜é‡">
    
```python
from zai import ZaiClient
import os

# ä»ç¯å¢ƒå˜é‡è¯»å– API Key
client = ZaiClient(api_key=os.getenv("ZAI_API_KEY")).zhipu

# æˆ–è€…ç›´æ¥ä½¿ç”¨ï¼ˆå¦‚æœå·²è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰
client = ZaiClient().zhipu
```

  </Tab>
  <Tab title="ç›´æ¥è®¾ç½®">
    
```python
from zai import ZaiClient

# ç›´æ¥è®¾ç½® API Key
client = ZaiClient(api_key="your-api-key").zhipu
```

  </Tab>
</Tabs>

#### åŸºç¡€å¯¹è¯

```python
from zai import ZaiClient

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = ZaiClient(api_key="your-api-key").zhipu

# åˆ›å»ºèŠå¤©å®Œæˆè¯·æ±‚
response = client.chat.completions.create(
    model="glm-4",
    messages=[
        {"role": "user", "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±"}
    ]
)

# è·å–å›å¤
print(response.choices[0].message.content)
```

#### æµå¼å¯¹è¯

```python
# åˆ›å»ºæµå¼èŠå¤©è¯·æ±‚
stream = client.chat.completions.create(
    model="glm-4",
    messages=[
        {"role": "user", "content": "å†™ä¸€é¦–å…³äºæ˜¥å¤©çš„è¯—"}
    ],
    stream=True
)

# å¤„ç†æµå¼å“åº”
for chunk in stream:
    if chunk.choices[0].delta.content is not None:
        print(chunk.choices[0].delta.content, end="", flush=True)

print()  # æ¢è¡Œ
```

#### å¤šè½®å¯¹è¯

```python
# ç»´æŠ¤å¯¹è¯å†å²
conversation = [
    {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„AIåŠ©æ‰‹"}
]

def chat_with_ai(user_input):
    # æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
    conversation.append({"role": "user", "content": user_input})
    
    # åˆ›å»ºè¯·æ±‚
    response = client.chat.completions.create(
        model="glm-4",
        messages=conversation
    )
    
    # è·å–AIå›å¤
    ai_response = response.choices[0].message.content
    
    # æ·»åŠ AIå›å¤åˆ°å¯¹è¯å†å²
    conversation.append({"role": "assistant", "content": ai_response})
    
    return ai_response

# ä½¿ç”¨ç¤ºä¾‹
print(chat_with_ai("ä½ å¥½"))
print(chat_with_ai("æˆ‘æƒ³äº†è§£Pythonç¼–ç¨‹"))
print(chat_with_ai("èƒ½ç»™æˆ‘ä¸€ä¸ªç®€å•çš„ä¾‹å­å—ï¼Ÿ"))
```

### å®Œæ•´ç¤ºä¾‹

```python
from zai import ZaiClient
import os

def main():
    # åˆå§‹åŒ–å®¢æˆ·ç«¯
    client = ZaiClient(api_key=os.getenv("ZAI_API_KEY")).zhipu
    
    print("æ¬¢è¿ä½¿ç”¨ Z.ai èŠå¤©æœºå™¨äººï¼è¾“å…¥ 'quit' é€€å‡ºã€‚")
    
    # å¯¹è¯å†å²
    conversation = [
        {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„AIåŠ©æ‰‹"}
    ]
    
    while True:
        # è·å–ç”¨æˆ·è¾“å…¥
        user_input = input("æ‚¨: ")
        
        if user_input.lower() == 'quit':
            break
        
        try:
            # æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            conversation.append({"role": "user", "content": user_input})
            
            # åˆ›å»ºèŠå¤©è¯·æ±‚
            response = client.chat.completions.create(
                model="glm-4",
                messages=conversation,
                temperature=0.7,
                max_tokens=1000
            )
            
            # è·å–AIå›å¤
            ai_response = response.choices[0].message.content
            print(f"AI: {ai_response}")
            
            # æ·»åŠ AIå›å¤åˆ°å¯¹è¯å†å²
            conversation.append({"role": "assistant", "content": ai_response})
            
        except Exception as e:
            print(f"å‘ç”Ÿé”™è¯¯: {e}")
    
    print("å†è§ï¼")

if __name__ == "__main__":
    main()
```

### é”™è¯¯å¤„ç†

```python
from zai import ZaiClient
import zai

def robust_chat(message):
    client = ZaiClient(api_key="your-api-key").zhipu
    
    try:
        response = client.chat.completions.create(
            model="glm-4",
            messages=[{"role": "user", "content": message}]
        )
        return response.choices[0].message.content
        
    except zai.APIStatusError as err:
        return f"APIçŠ¶æ€é”™è¯¯: {err}"
    except zai.APITimeoutError as err:
        return f"è¯·æ±‚è¶…æ—¶: {err}"
    except Exception as err:
        return f"å…¶ä»–é”™è¯¯: {err}"

# ä½¿ç”¨ç¤ºä¾‹
result = robust_chat("ä½ å¥½")
print(result)
```

### é«˜çº§é…ç½®

```python
import httpx
from zai import ZaiClient

# è‡ªå®šä¹‰HTTPå®¢æˆ·ç«¯
httpx_client = httpx.Client(
    limits=httpx.Limits(
        max_keepalive_connections=20,
        max_connections=100
    ),
    timeout=30.0
)

# åˆ›å»ºå¸¦è‡ªå®šä¹‰é…ç½®çš„å®¢æˆ·ç«¯
client = ZaiClient(
    api_key="your-api-key",
    base_url="https://api.z.ai/api/paas/v4/",
    timeout=httpx.Timeout(timeout=300.0, connect=8.0),
    max_retries=3,
    http_client=httpx_client
)
```

## é«˜çº§åŠŸèƒ½

### å‡½æ•°è°ƒç”¨ (Function Calling)

å‡½æ•°è°ƒç”¨å…è®¸ AI æ¨¡å‹è°ƒç”¨æ‚¨å®šä¹‰çš„å‡½æ•°æ¥è·å–å®æ—¶ä¿¡æ¯æˆ–æ‰§è¡Œç‰¹å®šæ“ä½œã€‚

#### å®šä¹‰å’Œä½¿ç”¨å‡½æ•°

```python
from zai import ZaiClient
import json

# å®šä¹‰å‡½æ•°
def get_weather(location, date=None):
    """è·å–å¤©æ°”ä¿¡æ¯"""
    # æ¨¡æ‹Ÿå¤©æ°”APIè°ƒç”¨
    return {
        "location": location,
        "date": date or "ä»Šå¤©",
        "weather": "æ™´å¤©",
        "temperature": "25Â°C",
        "humidity": "60%"
    }

def get_stock_price(symbol):
    """è·å–è‚¡ç¥¨ä»·æ ¼"""
    # æ¨¡æ‹Ÿè‚¡ç¥¨APIè°ƒç”¨
    return {
        "symbol": symbol,
        "price": 150.25,
        "change": "+2.5%"
    }

# å‡½æ•°æè¿°
tools = [
    {
        "type": "function",
        "function": {
            "name": "get_weather",
            "description": "è·å–æŒ‡å®šåœ°ç‚¹çš„å¤©æ°”ä¿¡æ¯",
            "parameters": {
                "type": "object",
                "properties": {
                    "location": {
                        "type": "string",
                        "description": "åœ°ç‚¹åç§°"
                    },
                    "date": {
                        "type": "string",
                        "description": "æ—¥æœŸï¼Œæ ¼å¼ä¸ºYYYY-MM-DD"
                    }
                },
                "required": ["location"]
            }
        }
    },
    {
        "type": "function",
        "function": {
            "name": "get_stock_price",
            "description": "è·å–è‚¡ç¥¨å½“å‰ä»·æ ¼",
            "parameters": {
                "type": "object",
                "properties": {
                    "symbol": {
                        "type": "string",
                        "description": "è‚¡ç¥¨ä»£ç "
                    }
                },
                "required": ["symbol"]
            }
        }
    }
]

# ä½¿ç”¨å‡½æ•°è°ƒç”¨
client = ZaiClient(api_key="your-api-key").zhipu

response = client.chat.completions.create(
    model='glm-4',
    messages=[
        {'role': 'user', 'content': 'åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ'}
    ],
    tools=tools,
    tool_choice="auto"
)

# å¤„ç†å‡½æ•°è°ƒç”¨
if response.choices[0].message.tool_calls:
    for tool_call in response.choices[0].message.tool_calls:
        function_name = tool_call.function.name
        function_args = json.loads(tool_call.function.arguments)
        
        if function_name == "get_weather":
            result = get_weather(**function_args)
            print(f"å¤©æ°”ä¿¡æ¯ï¼š{result}")
        elif function_name == "get_stock_price":
            result = get_stock_price(**function_args)
            print(f"è‚¡ç¥¨ä¿¡æ¯ï¼š{result}")
else:
    print(response.choices[0].message.content)
```

#### ç½‘ç»œæœç´¢å·¥å…·

```python
from zai import ZaiClient

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = ZaiClient(api_key="your-api-key").zhipu

# ä½¿ç”¨ç½‘ç»œæœç´¢å·¥å…·
response = client.chat.completions.create(
    model='glm-4',
    messages=[
        {'role': 'system', 'content': 'You are a helpful assistant.'},
        {'role': 'user', 'content': 'What is artificial intelligence?'},
    ],
    tools=[
        {
            'type': 'web_search',
            'web_search': {
                'search_query': 'What is artificial intelligence?',
                'search_result': True,
            },
        }
    ],
    temperature=0.5,
    max_tokens=2000,
)

print(response)
```

### å¤šæ¨¡æ€å¤„ç†

#### å›¾åƒç†è§£

```python
import base64
from zai import ZaiClient

def encode_image(image_path):
    """å°†å›¾åƒç¼–ç ä¸ºbase64æ ¼å¼"""
    with open(image_path, 'rb') as image_file:
        return base64.b64encode(image_file.read()).decode('utf-8')

client = ZaiClient(api_key="your-api-key").zhipu

# æ–¹å¼1ï¼šä½¿ç”¨å›¾åƒURL
response = client.chat.completions.create(
    model="glm-4v",
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": "è¿™å¼ å›¾ç‰‡é‡Œæœ‰ä»€ä¹ˆï¼Ÿè¯·è¯¦ç»†æè¿°ã€‚"
                },
                {
                    "type": "image_url",
                    "image_url": {
                        "url": "https://example.com/image.jpg"
                    }
                }
            ]
        }
    ]
)

print(response.choices[0].message.content)

# æ–¹å¼2ï¼šä½¿ç”¨base64ç¼–ç çš„å›¾åƒ
base64_image = encode_image('path/to/your/image.jpg')

response = client.chat.completions.create(
    model="glm-4v",
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": "åˆ†æè¿™å¼ å›¾ç‰‡ä¸­çš„å†…å®¹"
                },
                {
                    "type": "image_url",
                    "image_url": {
                        "url": f"data:image/jpeg;base64,{base64_image}"
                    }
                }
            ]
        }
    ]
)

print(response.choices[0].message.content)
```

#### å›¾åƒç”Ÿæˆ

```python
# å›¾åƒç”Ÿæˆ
response = client.images.generations(
    model="cogview-3",
    prompt="ä¸€å¹…ç¾ä¸½çš„å±±æ°´ç”»ï¼Œä¸­å›½ä¼ ç»Ÿé£æ ¼ï¼Œæ°´å¢¨ç”»",
    size="1024x1024",
    quality="standard",
    n=1
)

image_url = response.data[0].url
print(f"ç”Ÿæˆçš„å›¾åƒURL: {image_url}")

# é«˜è´¨é‡å›¾åƒç”Ÿæˆ
response = client.images.generations(
    model="cogview-3-plus",
    prompt="æœªæ¥åŸå¸‚çš„æ¦‚å¿µè®¾è®¡ï¼Œç§‘å¹»é£æ ¼ï¼Œé«˜æ¸…ç»†èŠ‚",
    size="1024x1024",
    quality="hd",
    n=2
)

for i, image in enumerate(response.data):
    print(f"å›¾åƒ {i+1} URL: {image.url}")
```

#### è§†é¢‘ç”Ÿæˆ

```python
from zai import ZaiClient

client = ZaiClient().zhipu

# æäº¤ç”Ÿæˆä»»åŠ¡
response = client.videos.generations(
    model="cogvideox-2",  # ä½¿ç”¨çš„è§†é¢‘ç”Ÿæˆæ¨¡å‹
    image_url=image_url,  # æä¾›çš„å›¾ç‰‡URLåœ°å€æˆ–è€… Base64 ç¼–ç 
    prompt="è®©ç”»é¢åŠ¨èµ·æ¥",  
    quality="speed",  # è¾“å‡ºæ¨¡å¼ï¼Œ"quality"ä¸ºè´¨é‡ä¼˜å…ˆï¼Œ"speed"ä¸ºé€Ÿåº¦ä¼˜å…ˆ
    with_audio=True,
    size="1920x1080",  # è§†é¢‘åˆ†è¾¨ç‡ï¼Œæ”¯æŒæœ€é«˜4Kï¼ˆå¦‚: "3840x2160"ï¼‰
    fps=30,  # å¸§ç‡ï¼Œå¯é€‰ä¸º30æˆ–60
)
print(response)

# è·å–ç”Ÿæˆç»“æœ
result = client.videos.retrieve_videos_result(id=response.id)
print(result)
```

### æ–‡æœ¬åµŒå…¥

```python
# åŸºç¡€æ–‡æœ¬åµŒå…¥
response = client.embeddings.create(
    model="embedding-2",
    input=[
        "è¿™æ˜¯ç¬¬ä¸€æ®µæ–‡æœ¬",
        "è¿™æ˜¯ç¬¬äºŒæ®µæ–‡æœ¬",
        "è¿™æ˜¯ç¬¬ä¸‰æ®µæ–‡æœ¬"
    ]
)

for i, embedding in enumerate(response.data):
    print(f"æ–‡æœ¬{i+1}çš„åµŒå…¥å‘é‡ç»´åº¦: {len(embedding.embedding)}")
    print(f"å‰5ä¸ªç»´åº¦çš„å€¼: {embedding.embedding[:5]}")

# è®¡ç®—æ–‡æœ¬ç›¸ä¼¼åº¦
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity

def calculate_similarity(texts):
    """è®¡ç®—æ–‡æœ¬é—´çš„ç›¸ä¼¼åº¦"""
    response = client.embeddings.create(
        model="embedding-2",
        input=texts
    )
    
    embeddings = [data.embedding for data in response.data]
    embeddings_array = np.array(embeddings)
    
    # è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
    similarity_matrix = cosine_similarity(embeddings_array)
    
    return similarity_matrix

# ä½¿ç”¨ç¤ºä¾‹
texts = [
    "æˆ‘å–œæ¬¢åƒè‹¹æœ",
    "è‹¹æœæ˜¯æˆ‘æœ€çˆ±çš„æ°´æœ",
    "ä»Šå¤©å¤©æ°”å¾ˆå¥½"
]

similarity = calculate_similarity(texts)
print("ç›¸ä¼¼åº¦çŸ©é˜µ:")
print(similarity)
```

### æµå¼å¤„ç†

```python
class StreamProcessor:
    def __init__(self, client):
        self.client = client
        self.full_response = ""
    
    def stream_chat(self, messages, model="glm-4", callback=None):
        """æµå¼èŠå¤©å¤„ç†"""
        stream = self.client.chat.completions.create(
            model=model,
            messages=messages,
            stream=True
        )
        
        self.full_response = ""
        for chunk in stream:
            if chunk.choices[0].delta.content is not None:
                content = chunk.choices[0].delta.content
                self.full_response += content
                
                if callback:
                    callback(content, self.full_response)
                else:
                    print(content, end="", flush=True)
        
        print()  # æ¢è¡Œ
        return self.full_response

# ä½¿ç”¨ç¤ºä¾‹
processor = StreamProcessor(client)

# è‡ªå®šä¹‰å›è°ƒå‡½æ•°
def on_token_received(token, full_text):
    # å¯ä»¥åœ¨è¿™é‡Œå®ç°å®æ—¶å¤„ç†é€»è¾‘
    print(token, end="", flush=True)

response = processor.stream_chat(
    messages=[{"role": "user", "content": "å†™ä¸€ä¸ªPythonå‡½æ•°æ¥è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—"}],
    callback=on_token_received
)
```

## è·å–å¸®åŠ©

<CardGroup cols={2}>
  <Card title="GitHubä»“åº“" icon="github" href="https://github.com/THUDM/z-ai-sdk-python">
    æŸ¥çœ‹æºä»£ç ã€æäº¤é—®é¢˜ã€å‚ä¸è´¡çŒ®
  </Card>
  <Card title="API å‚è€ƒ" icon="book" href="/api-reference">
    æŸ¥çœ‹å®Œæ•´çš„ API æ–‡æ¡£
  </Card>
  <Card title="ç¤ºä¾‹é¡¹ç›®" icon="code" href="https://github.com/THUDM/z-ai-sdk-python/tree/main/examples">
    æµè§ˆæ›´å¤šå®é™…åº”ç”¨ç¤ºä¾‹
  </Card>
  <Card title="æœ€ä½³å®è·µ" icon="star" href="https://github.com/THUDM/z-ai-sdk-python">
    å­¦ä¹  SDK ä½¿ç”¨çš„æœ€ä½³å®è·µ
  </Card>
</CardGroup>

<Note>
æœ¬SDKåŸºäºæ™ºè°±AIæœ€æ–°çš„APIè§„èŒƒå¼€å‘ï¼Œç¡®ä¿ä¸å¹³å°åŠŸèƒ½ä¿æŒåŒæ­¥æ›´æ–°ã€‚å»ºè®®å®šæœŸæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ä»¥è·å¾—æœ€ä½³ä½“éªŒã€‚
</Note>